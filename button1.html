<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éú„Çø„É≥1</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>A10„Éó„É≠„Éà„Çø„Ç§„Éó</h1>
        <div class="user-name" id="userNameDisplay"></div>
    </header>
    
    <main>
        <h1>„É¶„Éº„Ç∂„Éº‰∏ÄË¶ß</h1>
        <div class="users-container" id="usersContainer">
            <!-- „É¶„Éº„Ç∂„Éº„Ç´„Éº„Éâ„Åå„Åì„Åì„Å´ÂãïÁöÑ„Å´ËøΩÂä†„Åï„Çå„Åæ„Åô -->
        </div>
    </main>
    
    <footer>
        <a href="button1.html" class="footer-btn">„Éú„Çø„É≥1</a>
        <a href="button2.html" class="footer-btn">„Éú„Çø„É≥2</a>
        <a href="team.html" class="footer-btn team-btn">üë•</a>
        <a href="settings.html" class="footer-btn settings-btn">‚öôÔ∏è</a>
    </footer>
    
    <script>
        function getUserProfile() {
            const storedUsername = localStorage.getItem('username') || '';
            const raw = localStorage.getItem('userProfile');
            let profile = { username: storedUsername, gender: '', birthdate: '', hobbies: [], icon: '' };
            if (raw) {
                try {
                    const parsed = JSON.parse(raw);
                    profile = { ...profile, ...parsed };
                } catch (e) {}
            }
            if (!profile.username && storedUsername) profile.username = storedUsername;
            return profile;
        }

        function applyHeaderProfile() {
            const el = document.getElementById('userNameDisplay');
            if (!el) return;

            const profile = getUserProfile();
            if (!profile.username) {
                el.textContent = '';
                return;
            }

            const iconHtml = profile.icon ? `<span class="user-icon">${profile.icon}</span>` : '';
            el.innerHTML =
                `<span class="user-name-content">` +
                iconHtml +
                `<span class="user-name-text">${profile.username}</span>` +
                `</span>`;
        }

        applyHeaderProfile();

        // „É¶„Éº„Ç∂„Éº„É™„Çπ„Éà„ÅÆË°®Á§∫
        function getAllUsers() {
            const raw = localStorage.getItem('allUsers');
            if (!raw) return [];
            try {
                return JSON.parse(raw);
            } catch (e) {
                return [];
            }
        }

        function getHobbyDisplayName(hobby) {
            const hobbyMap = {
                'sports': '„Çπ„Éù„Éº„ÉÑ',
                'games': '„Ç≤„Éº„É†',
                'music': 'Èü≥Ê•Ω',
                'reading': 'Ë™≠Êõ∏',
                'travel': 'ÊóÖË°å'
            };
            return hobbyMap[hobby] || hobby;
        }

        function renderUsers() {
            const usersContainer = document.getElementById('usersContainer');
            const users = getAllUsers();
            
            if (users.length === 0) {
                usersContainer.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">ÁôªÈå≤„Åï„Çå„Åü„É¶„Éº„Ç∂„Éº„ÅØ„ÅÑ„Åæ„Åõ„Çì„ÄÇ</p>';
                return;
            }

            usersContainer.innerHTML = users.map(user => {
                const icon = user.icon || '';
                const username = user.username || '„É¶„Éº„Ç∂„ÉºÂêç‰∏çÊòé';
                const department = user.department || 'Êú™Ë®≠ÂÆö';
                const selfIntroduction = user.selfIntroduction || 'Ëá™Â∑±Á¥π‰ªã„ÅØÊú™Ë®≠ÂÆö„Åß„Åô„ÄÇ';
                const hobbies = Array.isArray(user.hobbies) && user.hobbies.length > 0
                    ? user.hobbies.map(h => getHobbyDisplayName(h)).join('„ÄÅ')
                    : 'Êú™Ë®≠ÂÆö';

                return `
                    <div class="user-card">
                        <div class="user-card-header">
                            ${icon ? `<span class="user-card-icon">${icon}</span>` : ''}
                            <h3 class="user-card-name">${username}</h3>
                        </div>
                        <div class="user-card-body">
                            <div class="user-card-field">
                                <span class="user-card-label">Â≠¶ÈÉ®Ôºö</span>
                                <span class="user-card-value">${department}</span>
                            </div>
                            <div class="user-card-field">
                                <span class="user-card-label">Ëá™Â∑±Á¥π‰ªãÔºö</span>
                                <p class="user-card-introduction">${selfIntroduction}</p>
                            </div>
                            <div class="user-card-field">
                                <span class="user-card-label">Ë∂£Âë≥Ôºö</span>
                                <span class="user-card-value">${hobbies}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        renderUsers();
    </script>
</body>
</html>

